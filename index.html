<!doctype html>
<html lang="fi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Yhteinen sanaristikko (22x22, pilvisynkka)</title>
<style>
  :root { --cell: 34px; --gap: 2px; --n: 22; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif; }
  body { margin:0; background:#f4f6fa; color:#0b1116; }
  .wrap { display:grid; grid-template-columns: 1fr 300px; gap:16px; align-items:start; width:min(98vw,1300px); margin:0 auto; padding:20px; }
  .right { position:sticky; top:12px; }

  h1 { font-size:22px; margin:0 0 6px 0; font-weight:700; }
  .subhint { font-size:14px; color:#334155; background:#e7eef9; border:1px solid #c9d9f8; padding:8px 10px; border-radius:10px; margin:6px 0 12px; }

  .status { font-size:12px; color:#475569; display:flex; align-items:center; gap:8px; margin-bottom:8px; }
  .dot { width:8px; height:8px; border-radius:50%; background:#94a3b8; }
  .dot.ok { background:#16a34a; }
  .dot.err { background:#ef4444; }

  /* Lauta yhtenä gridinä */
  .board {
    display:inline-block;
    background:#d1d5db;
    padding:var(--gap);
    border:1px solid #d1d5db;
    border-radius:12px;
  }
  .board-grid{
    display:grid;
    grid-template-columns: var(--cell) repeat(var(--n), var(--cell)) var(--cell);
    grid-template-rows:    var(--cell) repeat(var(--n), var(--cell)) var(--cell);
    gap: var(--gap);
    background:#d1d5db;
    padding: var(--gap);
    border-radius:10px;
    box-sizing: border-box;
  }

  /* Tunnisteet */
  .label-cell{
    width:var(--cell); height:var(--cell);
    display:flex; align-items:center; justify-content:center;
    font-size:12px; font-weight:700; color:#0b1116;
    background:#f8fafc; border:1px solid #e5e7eb; border-radius:6px;
  }

  /* Solut */
  .cell{
    width:var(--cell); height:var(--cell);
    display:grid; place-items:center;
    background:#ffffff; border:1px solid #e5e7eb; border-radius:6px; position:relative;
  }
  .cell input{
    width:100%; height:100%;
    text-align:center; font-weight:800; font-size:18px; text-transform:uppercase;
    background:transparent; border:none; color:#0b1116; outline:none;
    autocomplete:off; autocapitalize:off; autocorrect:off; spellcheck:false;
  }
  .cell.black{ background:#0f1720; border-color:#0f1720; }
  .cell.black input{ visibility:hidden; pointer-events:none; }
  .cell.black::after{ content:""; position:absolute; inset:0; border-radius:6px;
    background:repeating-linear-gradient(45deg, #0f1720 0 8px, #142237 8px 16px); opacity:.9; }

  .disabled-overlay { pointer-events:none; opacity:.55; filter:grayscale(0.2); }

  .toolbar { display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin:12px 0 0; }
  .toolbar button, .toolbar input[type="text"], .toolbar input[type="file"], .toolbar label { background:#ffffff; color:#0b1116; border:1px solid #cbd5e1; border-radius:10px; padding:8px 10px; }
  .toolbar button:hover { background:#f1f5f9; cursor:pointer; }
  .toolbar .grow { flex:1; }
  a.link { color:#0b6bcb; text-decoration:underline; }

  .card { background:#ffffff; border:1px solid #cbd5e1; border-radius:12px; padding:12px; box-shadow:0 2px 10px #00000010; }
  .names { display:grid; grid-template-columns: 1fr; gap:8px; }
  .names input, .names select { width:100%; padding:10px; border:1px solid #cbd5e1; border-radius:10px; }
  .toggle { display:flex; align-items:center; gap:8px; font-size:14px; }
  .muted { color:#64748b; font-size:12px; }

  @media (max-width: 980px){ .wrap{ grid-template-columns: 1fr; } .right{ position:static; } }
</style>
</head>
<body>
<div class="wrap">
  <div class="left">
    <h1 id="title">Sanaristikko</h1>
    <div class="subhint">Klikkaa ruutua ja lisää kirjain. Ristikon huone on nettiosoitteen lopussa, Pekka lähettää linkin.</div>

    <div class="status"><span id="statusDot" class="dot"></span><span id="statusText">Offline-tila (paikallinen)</span><span id="activeInfo" class="muted"></span></div>

    <div class="board"><div id="boardGrid" class="board-grid"></div></div>

    <div class="toolbar" id="toolbar">
      <button id="save">Tallenna (.json)</button>
      <label>
        <input id="load" type="file" accept="application/json" style="display:none">
        <button id="loadBtn" type="button">Lataa (.json)</button>
      </label>
      <button id="clear">Tyhjennä ristikko (huone)</button>
      <span class="grow"></span>
      <input id="roomName" type="text" placeholder="Huoneen nimi (esim. POP1)" />
      <input id="roomTitle" type="text" placeholder="Huoneen otsikko (näkyy ylhäällä)" />
      <button id="makeLink">Luo linkki</button>
      <a id="roomLink" class="link" href="#" target="_blank" style="display:none">Avaa huone</a>
    </div>
  </div>

  <div class="right">
    <div class="card" style="margin-bottom:12px;">
      <div class="toggle"><input type="checkbox" id="lockBlack"> <label for="lockBlack">Lukitse mustat ruudut</label></div>
      <div class="muted" style="margin-top:6px;">Uudessa huoneessa mustat ovat lukossa oletuksena.</div>
    </div>

    <div class="card" style="margin-bottom:12px;">
      <div style="font-weight:600; margin-bottom:8px;">Pelaa Firebase-pilvessä</div>
      <div class="names" style="gap:10px;">
        <select id="playerSelect">
          <option value="">— Valitse nimimerkki —</option>
          <option>Enni</option><option>Esme</option><option>Marika</option><option>Mauri</option><option>Mirva</option>
          <option>Pekka</option><option>Pertti</option><option>Petri</option><option>Sini</option><option>Taru</option><option>Teemu</option>
        </select>
        <div class="toggle"><input type="checkbox" id="autoRelease"> <label for="autoRelease">Luovuta vuoro tallennettaessa</label></div>
        <div style="display:flex; gap:8px; flex-wrap:wrap;">
          <button id="cloudLoad">Lataa pilvestä</button>
          <button id="takeTurn" disabled>Ota vuoro</button>
          <button id="releaseTurn" disabled>Luovuta vuoro</button>
          <button id="cloudSave" disabled>Tallenna pilveen</button>
        </div>
        <div class="muted">Uusi peli alhaalla (Huone + Otsikko → Luo linkki). Pelaajat eivät muuta otsikkoa.</div>
      </div>
    </div>
  </div>
</div>

<script type="module">
// (JavaScript-koodi pysyy ennallaan)
</script>
</body>
</html>
